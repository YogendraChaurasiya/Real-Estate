<!-- property_details.html -->
<!DOCTYPE html>
<html lang="en">
<head>  
    <meta charset="UTF-8">
    <link
      rel="stylesheet"
      type="text/css"
      href="{{ url_for('static', filename='css/index_css.css') }}" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Property Details</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
</head>
<body>
    <header>
        <nav>
            <ul>
                <li><a href="/">Home</a></li>
                <li><a href="#properties">Properties</a></li>
                <li><a href="#testimonials">Testimonials</a></li>
                <li><a href="#contact">Contact</a></li>
                {% if 'user_id' in session %}
                <li><a href="/logout">Logout</a></li>
                {% else %}
                <li><a href="/client_login">Login</a></li>
                {% endif %}
                <li><a href="/sell_property">Sell Your Property</a></li>
            </ul>
        </nav>
    </header>
    <main>
        <section id="property-details">
            <h2>Property Details</h2>
            <h3>{{ property.owner_name }}</h3>
            <img src="/{{ property.image1 }}" alt="Property Image 1">
            <img src="/{{ property.image2 }}" alt="Property Image 2">
            <img src="/{{ property.image3 }}" alt="Property Image 3">
            <img src="/{{ property.image4 }}" alt="Property Image 4">
            <img src="/{{ property.image5 }}" alt="Property Image 5">
            <img src="/{{ property.image6 }}" alt="Property Image 6">
            <p>Address: {{ property.address }}</p>
            <p>Property Size: {{ property.property_size }}</p>
            <p>Property Type: {{ property.property_type }}</p>
            <p>Price: {{ property.price }}</p>
            <!-- Add button for booking appointment -->
            <form method="POST" action="/schedule_appointment?id={{ property.id }}&owner_name={{ property.owner_name }}">
                <label for="appointment_date">Appointment Date:</label>
                <input type="date" id="appointment_date" name="appointment_date" required><br><br>
                
                <label for="appointment_time">Appointment Time:</label>
                <input type="time" id="appointment_time" name="appointment_time" required><br><br>
                
                <input type="submit" value="Schedule Appointment"><br><br>

            </form>
            <button id="bookPropertyBtn" style="display:none;"><a href="{{ url_for('book_property', pid=property.id) }}">Book This Property</a></button><br><br>
            <button id="payamountBtn" style="display:none;"><a href="{{ url_for('down_payment', prop_id=property.id) }}">Make Down Payment</a></button>
            
        </section>
        
    </main>

    <script>
        // Function to show the buttons after 1 hour of the appointment time
        function showButtons() {
            document.getElementById('bookPropertyBtn').style.display = 'inline-block';
            document.getElementById('payamountBtn').style.display = 'inline-block';
        }

        // Get the appointment date and time
        var appointmentDate = new Date('{{ appointment_date }}');
        var appointmentTime = '{{ property.appointment_time }}';

        // Convert the appointment time to milliseconds
        var appointmentDateTime = new Date(appointmentDate.getFullYear(), appointmentDate.getMonth(), appointmentDate.getDate(), parseInt(appointmentTime.split(':')[0]), parseInt(appointmentTime.split(':')[1]), 0);

        // Calculate the time after 1 hour of the appointment
        var oneHourAfterAppointment = new Date(appointmentDateTime.getTime() + (1 * 60 * 60 * 1000));

        // Set a timeout to call showButtons() after 1 hour of the appointment time
        setTimeout(showButtons, oneHourAfterAppointment - Date.now());
    </script>
    
</body>
</html>
 